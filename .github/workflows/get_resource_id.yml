name: Retrieve id of resource
on: workflow_dispatch

env:
    AWS_ACCESS_KEY_ID: ${{ secrets.AWS_ACCESS_KEY_ID }}
    AWS_SECRET_ACCESS_KEY: ${{ secrets.AWS_SECRET_ACCESS_KEY }}
    AWS_REGION: 'us-east-1'
    TAG_KEY: 'Purpose'
    TAG_VALUE: 'SRE-POC'

jobs:
    get-id-of-resource:
        runs-on: ubuntu-latest
        steps:
        - name: get-id-by-name
          id: id-by-name
          run: |
            output=$(aws elbv2 describe-load-balancers --names pocSre --region $AWS_REGION| jq -r '.LoadBalancers[0].DNSName')
            echo "Query output:$output"

            # Retrieve by tag
            load_balancer_arns=$(aws elbv2 describe-load-balancers --query 'LoadBalancers[*].LoadBalancerArn' --output text)
            echo "2nd Query output: $load_balancer_arns"